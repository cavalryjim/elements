<div id="element_form_tabs">
  <ul>
    <li><a href="#element_tab1">Element</a></li>
    <li><a href="#element_tab2">Attachable</a></li>
  </ul>
  <div id="element_tab1">
    <fieldset id="element">
    <%= f.label :element %><br />
    <p>
      <%= f.label :name %><br />
      <%= f.text_field :name %>
    </p>
    <p>
      <%= f.label :parent %><br />
      <%= f.select :parent_id, options_for_select(Element, @element) {|i| "#{'-' * i.ancestry_depth.to_i} #{i.name} #{"(#{i.attachable.class})" if i.has_attachable?}" } %>
    </p>
    <p>
      <%= f.label :tag_list %><br />
      <%= f.text_field :tag_list %>
    </p>
  </div>
  <div id="element_tab2">
    <%= f.select "attachable_type", Element::COMPONENTS,
      { :prompt => "Select one:" },
      { :onchange => remote_function(
                        :url => new_component_elements_url,
                        :with => "'attachable_type='+this.value",
                        :update => "component")
      } %>
    <div id="component">
    <% if !f.object.nil? and f.object.has_attachable? %>
      <% f.fields_for :attachable, f.object.attachable do |builder|  %>
        <%= builder.hidden_field :attachable_type, :value => builder.object.class.to_s %>
        <%= render "#{f.object.attachable.class.to_s.tableize}/form", :f => builder %>
      <% end %>
    <% end %>
    </div>
  </div>
</div>
<script type="text/javascript">
  $(document).ready(function() {
    $("#element_form_tabs").tabs();
  });
</script>
